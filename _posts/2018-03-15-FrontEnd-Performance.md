---
layout: post
title: 前端性能优化
tags: [Front-End]
---

**摘要：**前端面试几乎都会问这样一个问题：说说你对前端性能优化的了解。这个问题相当于是开卷考试了，因为也没啥标准答案。但是还是有一些常见套路的，这里就尝试着罗列一些，希望能总结越多，理解越多。
{:.message}

其实，基本的思路大致有这么三个方向：

1. 基于浏览器渲染页面原理上的 CSS、JavaScript 语法层面的优化
2. 针对 HTTP 协议特性上的网络层面的优化，如合并、压缩资源等
3. 针对用户体验层面的交互逻辑优化，如懒加载等

在当前计算机物理性能的快速发展下，只要代码写得不是特别过分，即使使用了第一点中更好的语法也不会对前端性能提升很多。而第二点则是必须持续要做的，同时第三点现在也成为了性能优化的主要发力点。

基于以上后两点的思路，常见的手段和实践主要有以下几个方面：

## 网页内容

### 减少 http 请求次数

减少页面中的资源请求次数是缩短网页响应时间的关键。常见的技巧有：

+ 捆绑文件： 将多个脚本或样式文件打包成一个文件。
+ CSS Sprites：将多张图片拼成一张图片，由 CSS 控制局部图片的显示。
+ base64 转换：将较小的图片通过 base64 转换为字符串以减少 http 请求。

### 减少 DNS 查询次数

DNS 查询也会消耗响应时间。如果网页内容来自多个不同的 domain，那么浏览器首次解析这些 domain 就需要消耗一定的时间。所以我们应该尽可能少地使用外部资源或保持外部域名的少样性。

### 减少页面跳转次数

有时 302 的重定向是多种因素导致的，比如说服务转移、业务需要。但是从用户角度考虑，一次请求之后的多次页面跳转会带来更多的等待时间，这种等待会覆盖我们在技术层面种种优化尝试。

### 优化 ajax

常见的技巧有：

+ 添加 `Expires` 或 `Cache-Control` 报文头使响应可以被客户端缓存
+ 压缩响应内容
+ 减少 DNS 查询

### 延迟加载、提前加载

延迟加载是基于我们知道网页最初加载需要的最小内容集是什么，剩下的内容就可以加入延迟加载的集合中。JavaScript 是典型的可以延迟加载的内容。

提前加载则是为了提前加载接下来网页中访问的资源。

### 减少 DOM 元素数量

网页中过多的 DOM 元素对网页的加载和脚本的执行都是沉重的负担。通过 `document.getElementsByTagName('*').length` 便可计算出页面中 DOM 元素的数量。
