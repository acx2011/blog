---
layout: post
title: Webpack
tags: [Front-End]
---

**NOTE**: 当下 webpack 真是有点火，要说没听过或者不懂 webpack 都不好意思跟人说是个搞前端的。这里把我学习 webpack 的心得体会做个记录，证明一下我也算是个“前端配置工程师”了。
{:.message}

## What is webpack?

[webpack](https://webpack.js.org/) 不是一门语言，也不是什么框架，它其实就是一个工具：前端项目的模块打包工具。它做的事情是：分析前端项目的结构，找到 js、css 等或需要预处理，或需要预编译，或需要嵌入到页面模板中的所有相关资源作为模块，然后将其转换和打包为合适的格式供浏览器使用。

## Why webpack?

现在很多的网页其实都是功能丰富的应用，拥有着复杂的 JavaScript 代码和一大堆依赖的资源。为了简化开发的复杂度，前端社区涌现出了很多好的实践方法，比如说：

* 模块化：把复杂的业务逻辑和代码实现细化为小的文件。

* 扩展语言和预处理器：比如 TypeScript 这种在 JavaScript 基础上拓展的开发语言，能够实现目前版本的 JavaScript 不能直接使用的特性，之后还能转换为 JavaScript 文件使浏览器可以识别；还比如 Sass、Less 等 CSS 预处理器，可以像写程序一样写 css 文件。

这些改进大大提高了前端的开发效率，但是以上所有优化都需要挨个手动处理又是非常繁琐的。这就为 webpack 类工具的出现提供了需求。

## How to use webpack?

webpack 的工作方式是：把项目当做一个整体，通过一个给定的主文件（如 index.js），webpack 将从这个文件开始找到项目的所有依赖文件，使用 `loaders` 和 `plugins` 处理它们，最后打包成一个（或多个）浏览器可识别的 js 文件。

### 安装

webpack 可以使用 npm 安装，新建一个空的文件夹，在终端中转到该文件夹后执行以下命令就可以完成安装：

```shell
npm init
npm install --save-dev webpack
```

### 配置文件

新建一个名为 `webpack.config.js` 的文件，webpack 会自动引用这个文件中的配置选项。下面先贴一个比较基本的配置感受一下，不明白的后面都会一一介绍：

```js
const webpack = require('webpack'); // webpack 自身模块
const HtmlWebpackPlugin = require('html-webpack-plugin'); // 
const ExtractTextPlugin = require('extract-text-webpack-plugin'); //

module.exports = {
  entry: __dirname + "/src/app.js", // webpack 大显身手的入口文件
        output: {
            path: __dirname + "/build",
            filename: "bundle-[hash].js"
        },
        devtool: 'none',
        devServer: {
            contentBase: "./public", //本地服务器所加载的页面所在的目录
            historyApiFallback: true, //不跳转
            inline: true,
            hot: true
        },
        module: {
            rules: [{
                    test: /(\.jsx|\.js)$/,
                    use: {
                        loader: "babel-loader"
                    },
                    exclude: /node_modules/
                }, {
                    test: /\.css$/,
                    use: ExtractTextPlugin.extract({
                        fallback: "style-loader",
                        use: [{
                            loader: "css-loader",
                            options: {
                                modules: true
                            }
                        }, {
                            loader: "postcss-loader"
                        }],
                    })
                }
            }
        ]
    },
    plugins: [
        new webpack.BannerPlugin('版权所有，翻版必究'),
        new HtmlWebpackPlugin({
            template: __dirname + "/app/index.tmpl.html" //new 一个这个插件的实例，并传入相关的参数
        }),
        new webpack.optimize.OccurrenceOrderPlugin(),
        new webpack.optimize.UglifyJsPlugin(),
        new ExtractTextPlugin("style.css")

    ],
};
```